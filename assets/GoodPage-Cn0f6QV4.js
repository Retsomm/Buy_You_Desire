import{j as e,a as I}from"./index-C4T-9ktt.js";import{r as o}from"./redux-CATTtzwa.js";import{g as f,G as b}from"./goodData-C1xfMorf.js";import{I as j,_ as v,c as R,a as C,d as P,T as m,b as z,R as H,e as M,P as T,f as $,g as w,h as F,i as S}from"./ui-CqXxwp-7.js";import{a as k}from"./cartThunks-BhA7MfJO.js";import"./vendor-Bzgz95E1.js";import"./cartActions-BYTkC441.js";var y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},V=function(t,n){return o.createElement(j,v({},t,{ref:n,icon:y}))},E=o.forwardRef(V),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"},A=function(t,n){return o.createElement(j,v({},t,{ref:n,icon:O}))},L=o.forwardRef(A);const N=(a,t)=>{const n=o.useMemo(()=>{const s=new Set;return a.forEach(i=>{i.tags.forEach(u=>s.add(u))}),Array.from(s).sort()},[a]),l=o.useMemo(()=>t.length===0?a:a.filter(s=>t.some(i=>s.tags.includes(i))),[a,t]);return{allTags:n,filteredProducts:l,hasFilters:t.length>0,filteredCount:l.length}},{Text:p}=m,G=({products:a,selectedTags:t,onTagsChange:n,filteredCount:l})=>{const[s,i]=o.useState(!0),{allTags:u}=N(a,t),g=r=>{const h=t.includes(r)?t.filter(x=>x!==r):[...t,r];n(h)},d=()=>{n([])};return e.jsx("div",{className:"product-filter",children:e.jsx(R,{activeKey:s?[]:["filter"],onChange:()=>i(!s),ghost:!0,expandIcon:({isActive:r})=>r?e.jsx(H,{className:"expand-icon"}):e.jsx(M,{className:"expand-icon"}),items:[{key:"filter",label:e.jsxs("div",{className:"collapse-label",children:[e.jsxs(p,{strong:!0,className:"title-text",children:[e.jsx(L,{className:"title-icon"}),"標籤篩選",t.length>0&&e.jsx("span",{className:"title-badge",children:t.length})]}),t.length>0&&e.jsx(z,{size:"small",icon:e.jsx(E,{}),onClick:r=>{r.stopPropagation(),d()},type:"text",className:"clear-button",children:"清除篩選"})]}),children:e.jsxs("div",{className:"filter-content",children:[e.jsx(C,{size:[8,8],wrap:!0,children:u.map(r=>e.jsx(P.CheckableTag,{checked:t.includes(r),onChange:()=>g(r),className:"filter-tag",children:r},r))}),t.length>0&&e.jsx("div",{className:"filter-summary",children:e.jsxs(p,{type:"secondary",children:["已選擇標籤：",t.join(", ")," | 符合條件的商品：",l," 個"]})})]})}]})})},{Text:B}=m,_=({currentPage:a,totalItems:t,itemsPerPage:n,onPageChange:l})=>{const s=(a-1)*n+1,i=Math.min(a*n,t),u=(g,d,r)=>d==="prev"?e.jsx("span",{className:"pagination-item-render",children:e.jsx($,{})}):d==="next"?e.jsx("span",{className:"pagination-item-render",children:e.jsx(w,{})}):d==="jump-prev"?e.jsx("span",{className:"pagination-item-render",children:e.jsx(F,{})}):d==="jump-next"?e.jsx("span",{className:"pagination-item-render",children:e.jsx(S,{})}):r;return t===0?null:e.jsxs("div",{className:"paginationContainer",children:[e.jsx(C,{children:e.jsxs(B,{type:"secondary",children:["顯示第 ",s," - ",i," 項，共 ",t," 項"]})}),e.jsx(T,{current:a,total:t,pageSize:n,onChange:l,itemRender:u,size:"small",className:"paginationWrapper",hideOnSinglePage:!0,showSizeChanger:!1})]})},D=(a,t=12)=>{const[n,l]=o.useState(1);o.useEffect(()=>{l(1)},[a]);const s=o.useMemo(()=>Math.ceil(a.length/t),[a.length,t]),i=o.useMemo(()=>{const h=(n-1)*t,x=h+t;return a.slice(h,x)},[a,n,t]),u=o.useCallback(()=>{l(1)},[]),g=o.useCallback(h=>{h>=1&&h<=s&&l(h)},[s]),d=o.useCallback(()=>{n<s&&l(n+1)},[n,s]),r=o.useCallback(()=>{n>1&&l(n-1)},[n]);return{currentPage:n,totalPages:s,currentItems:i,totalItems:a.length,itemsPerPage:t,hasNextPage:n<s,hasPrevPage:n>1,goToPage:g,nextPage:d,prevPage:r,resetToFirstPage:u}},{Text:W}=m,Z=()=>{const[a,t]=o.useState([]),n=I(),{filteredProducts:l}=N(f,a),{currentPage:s,totalPages:i,currentItems:u,totalItems:g,goToPage:d}=D(l,12),r=c=>{t(c)},h=c=>{d(c),window.scrollTo({top:0,behavior:"smooth"})},x=c=>{n(k(c))};return e.jsxs("div",{className:"GoodPage",children:[e.jsx(G,{products:f,selectedTags:a,onTagsChange:r,filteredCount:l.length}),e.jsx("div",{className:"goodList",children:u.map(c=>e.jsx(b,{title:c.title,description:c.description,price:c.price,tags:c.tags,gradient:c.gradient,onAddToCart:()=>x(c)},c.id))}),l.length>0&&e.jsx(_,{currentPage:s,totalPages:i,totalItems:g,itemsPerPage:12,onPageChange:h}),l.length===0&&e.jsx("div",{className:"no-products-message",children:e.jsx(W,{className:"no-products-text",children:"沒有符合篩選條件的商品，請嘗試調整篩選條件"})})]})};export{Z as default};
